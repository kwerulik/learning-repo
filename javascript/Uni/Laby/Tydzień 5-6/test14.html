<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather Stations in Poland</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""></script>
    <style>
        #map {
            height: 600px;
            width: 100%;
        }
    </style>
</head>
<body>
    <h1>Weather Stations in Poland</h1>
    <div id="map"></div>

    <script>
        // Initialize the map and set view to center of Poland
        var map = L.map('map').setView([52.2297, 21.0122], 6); // Coordinates of Warsaw

        // Add OpenStreetMap tiles
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        // Fetch data from the IMGW API
        var xhr = new XMLHttpRequest();
        xhr.open("GET", "https://danepubliczne.imgw.pl/api/data/meteo/", true);
        xhr.onload = function () {
            if (xhr.status === 200) {
                var data = JSON.parse(xhr.responseText);
                var counter = 0;

                // Iterate through the weather stations data
                data.forEach(function (station) {
                    if (counter < 20 && station.lat && station.lon) { // Limit to 20 stations with valid coordinates
                        // Create a marker for each station
                        var marker = L.marker([station.lat, station.lon]).addTo(map);
                        
                        // Add popup to marker with station data
                        marker.bindPopup(`
                            <b>Station: ${station.stacja}</b><br>
                            Temperature: ${station.temperatura} Â°C<br>
                            Pressure: ${station.cisnienie} hPa<br>
                            Wind Speed: ${station.predkosc_wiatru} m/s
                        `);
                        counter++;
                    }
                });
            } else {
                console.error("Error fetching data from the API.");
            }
        };
        xhr.send();
    </script>
</body>
</html>

<!-- <html>
<head>

</head>
<body>
    <button id="ala"> alala</button>
    <div id="sla">cos</div>
<script>

    var a=document.querySelector('#sla');

    document.querySelector('#ala').addEventListener('click', function() {

    var r= new XMLHttpRequest();		

    //tworzymy nowy obiekt typu XMLHttpRequest,
    //r.open('GET','https://jsonplaceholder.typicode.com/users', true);
    r.open('GET','https://danepubliczne.imgw.pl/api/data/synop', true);
    r.onload=function(){

    var data=JSON.parse(r.responseText);
    //document.write(data[0].name);
    //document.write('ala');
    document.write(data[0].id_stacji);


    };

    r.send();


    });
</script>
</body>
</html> -->
<!-- <html>
<head>

</head>
<body>

<script>

    const xhr = new XMLHttpRequest();

    xhr.addEventListener("load",  e => {
        if (xhr.status === 200) {
            const json = JSON.parse(xhr.response);
            console.log(json[0].id_stacji);
        }
    });

    xhr.open("GET", "https://danepubliczne.imgw.pl/api/data/synop", true);
    xhr.send();
</script>
</body>
</html> -->

